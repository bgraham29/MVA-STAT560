seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree <- cutree(seed.c, k = 1)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree <- cutree(seed.c, k = 2)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree <- cutree(seed.c, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
m
seed.pca <- princomp(seed)
pairs(seed.pca$scores[, 1:3], col = tree, pch = 20)
pairs(seed.pca$scores, col = tree, pch = 20)
pairs(seed.pca$scores[, 1:2], col = tree, pch = 20)
plot(seed.pca$scores[, 1:2], col = tree, pch = 20)
plot(seed.pca$scores[, 1:2], col = tree, pch = 20, cex = 2)
plot(seed, col = tree)
abline(v = 3.5, col = "blue", lty = "dashed")
plot(seed.c)
abline(v = 3.5, col = "blue", lty = "dashed")
plot(seed.c)
abline(h = 3.6, col = "blue", lty = "dashed")
plot(seed.c)
abline(h = 31, col = "blue", lty = "dashed")
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "ward")
plot(seed.c)
abline(h = 501, col = "blue", lty = "dashed")
abline(h = 250, col = "red", lty = "dashed")
abline(h = 257, col = "red", lty = "dashed")
abline(h = 270, col = "red", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
plot(seed.c)
abline(h = 501, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
abline(h = 550, col = "blue", lty = "dashed")
plot(seed.c)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
seed.s <- hclust(dist(seed.dist, method = "euclidean"), method = "single")
plot(seed.s)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "complete")
plot(seed.c)
seed.s <- hclust(dist(seed.dist, method = "manhattan"), method = "single")
plot(seed.s)
seed.s <- hclust(dist(seed.dist, method = "maximum"), method = "single")
plot(seed.s)
seed.s <- hclust(dist(seed.dist, method = "canberra"), method = "single")
plot(seed.s)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "complete")
plot(seed.c)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "average")
plot(seed.c)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "complete")
plot(seed.c)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "average")
plot(seed.c)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "complete")
plot(seed.c)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "average")
plot(seed.c)
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "average")
plot(seed.c)
abline(h = 550, col = "blue", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward")
plot(seed.w)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
plot(seed.c)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 35, col = "blue", lty = "dashed")
abline(h = 22, col = "red", lty = "dashed")
abline(h = 25, col = "red", lty = "dashed")
abline(h = 24, col = "red", lty = "dashed")
plot(seed.c)
abline(h = 35, col = "blue", lty = "dashed")
abline(h = 24, col = "red", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward")
seed.c <- hclust(dist(seed.dist, method = "euclidean"), method = "complete")
plot(seed.c)
abline(h = 35, col = "blue", lty = "dashed")
abline(h = 24, col = "red", lty = "dashed")
plot(seed.c)
abline(h = 60, col = "blue", lty = "dashed")
abline(h = 40, col = "red", lty = "dashed")
c.tree3 <- cutree(seed.c, k = 3)
c.tree6 <- cutree(seed.c, k = 6)
seed.a <- hclust(dist(seed.dist, method = "euclidean"), method = "average")
plot(seed.a)
abline(h = 35, col = "blue", lty = "dashed")
abline(h = 24, col = "red", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward")
plot(seed.w)
abline(h = 550, col = "blue", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward.D2")
plot(seed.w)
abline(h = 550, col = "blue", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward.D")
plot(seed.w)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
seed.w <- hclust(dist(seed.dist, method = "euclidean"), method = "ward.D2")
plot(seed.w)
abline(h = 550, col = "blue", lty = "dashed")
abline(h = 300, col = "red", lty = "dashed")
plot(seed.w)
abline(h = 200, col = "blue", lty = "dashed")
abline(h = 80, col = "red", lty = "dashed")
plot(seed.w)
abline(h = 200, col = "blue", lty = "dashed")
abline(h = 85, col = "red", lty = "dashed")
seed.tree.c <- cutree(seed.c, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree.c <- cutree(seed.c, k = 6)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree.c <- cutree(seed.c, k = 3)
seed.si <- silhouette(seed.tree.c, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree.c <- cutree(seed.c, k = 6)
seed.si <- silhouette(seed.tree.c, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, col = seed.tree)
seed.tree.c <- cutree(seed.w, k = 6)
seed.si <- silhouette(seed.tree.c, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree.c <- cutree(seed.w, k = 3)
seed.si <- silhouette(seed.tree.c, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree <- cutree(seed.a, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree <- cutree(seed.a, k = 6)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree <- cutree(seed.w, k = 6)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree <- cutree(seed.w, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.tree <- cutree(seed.a, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist), main =
    "Silhouette plot of \"average\" method for clustering seed data") 
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, main =
    "Silhouette plot of \"average\" method for clustering seed data")
plot(seed.a)
abline(h = 35, col = "blue", lty = "dashed")
abline(h = 24, col = "red", lty = "dashed")
seed.tree <- cutree(seed.a, k = 3)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, main =
    "Silhouette plot of \"average\" method for clustering seed data")
plot(seed.si, main =
    "Silhouette plot of \"average linkage\" for clustering seed data")
plot(seed.pca$scores[, 1:2], col = seed.tree, pch = 20, cex = 2)
seed.tree <- cutree(seed.a, k = 6)
plot(seed, col = tree)
plot(seed.pca$scores[, 1:2], col = seed.tree, pch = 20, cex = 2)
seed.tree <- cutree(seed.a, k = 3)
plot(seed, col = tree, main = "Three clusters")
plot(seed.pca$scores[, 1:2], col = seed.tree, pch = 20, cex = 2, 
    main = "Three clusters")
plot(seed, col = tree, main = "Six clusters")
plot(seed.pca$scores[, 1:2], col = seed.tree, pch = 20, cex = 2, 
    main = "Six clusters")
seed.tree <- cutree(seed.a, k = 6)
plot(seed.pca$scores[, 1:2], col = seed.tree, pch = 20, cex = 2, 
    main = "Six clusters")
seed.tree <- cutree(seed.a, k = 2)
seed.si <- silhouette(seed.tree, dmatrix = as.matrix(seed.dist)) 
plot(seed.si, main =
    "Silhouette plot of \"average linkage\" for clustering seed data")
seed.pam <- pam(seed, 3)
seed.pam <- pam(seed, 3)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 6)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 2)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 3)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 2)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 4)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, )
seed.pam <- pam(seed, 7)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 8)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 2)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 3)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 2)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 6)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 3)
plot(silhouette(seed.pam))
seed.pam <- pam(seed, 6)
plot(silhouette(seed.pam))
plot(seed, col = seed.pam$cluster)
seed.pam <- pam(seed, 3)
plot(silhouette(seed.pam))
seed.pc <- seed.pca$scores[, 1:2]
plot(seed.pc, col = seed.pam$cluster)
plot(seed.pc, col = seed.pam$cluster, pch = 20, cex = 2)
plot(seed.pc, col = seed.pam$cluster, pch = 20, cex = 2, main = 
    "Clusters identified by PAM")
seed.kmeans <- kmeans(seed, 3)
kmeans.si <- silhouette(seed.kmeans$cluster, seed.dist)
plot(kmeans.si)
seed$pam <- seed.pam$cluster
seed$kmean <- seed.kmeans$cluster
sum(seed$pam == seed$kmean)
dim(seed)
seed[, c(pam, kmean)]
seed[, pam:kmean]
head(seed)
seed$pam - seed$kmean
seed[which(seed$pam != seed$kmean),]
str(seed.kmeans)
seed.kmeans1 <- seed.kmeans
seed.kmeans2 <- kmeans(seed, 3)
str(seed.kmeans2)
seed.kmeans3 <- kmeans(seed, 3)
str(seed.kmeans3)
seed.kmeans4 <- kmeans(seed, 3)
seed.kmeans5 <- kmeans(seed, 3)
seed.kmeans6 <- kmeans(seed, 3)
seed.kmeans7 <- kmeans(seed, 3)
seed.kmeans8 <- kmeans(seed, 3)
seed.kmeans4%tot.withinss
seed.kmeans4$tot.withinss
seed.kmeans5$tot.withinss
seed.kmeans6$tot.withinss
seed.kmeans7$tot.withinss
seed.kmeans8$tot.withinss
seed.kmeans1$tot.withinss
seed.kmeans2$tot.withinss
seed.kmeans3$tot.withinss
WSS <- rep(NA, 100)
for(i in 1:100) {
    WSS[i] <- kmeans(seed, 3)$tot.withinss
}
min(WSS)
max(WSS)
str(seed.kmeans)
WSS <- rep(NA, 500)
for(i in 1:500) {
    WSS[i] <- kmeans(seed, 3)$tot.withinss
}
min(WSS)
max(WSS)
for(i in 1:500) {
    set.seed <- i
    WSS[i] <- kmeans(seed, 3)$tot.withinss
}
min(WSS)
head(WSS)
sum(round(WSS,4) == 591.9714)
kmeans
str(seed.kmeans)
str(seed.kmeans2)
head(seed)
seed <- seed[, -8:9]
seed <- seed[, -(8:9)]
seed
head(seed)
WSS <- rep(NA, 100)
for(i in 1:100) {
    WSS[i] <- kmeans(seed, 3)$tot.withinss
}
min(WSS)
max(WSS)
kmean$tot.withinss
seed.kmeans$tot.withinss
kmeans.si <- silhouette(seed.kmeans$cluster, seed.dist)
plot(kmeans.si)
plot(seed.pc, col = seed.kmeans$cluster, pch = 20, cex = 2, main = 
    "Clusters identified by k-means")
WSS <- rep(NA, 1000)
for(i in 1:1000) {
    WSS[i] <- kmeans(seed, 3)$tot.withinss
}
min(WSS)
str(seed.kmeans)
kmeans(seed, 6)$tot.withinss
kmeans(seed, 5)$tot.withinss
kmeans(seed, 4)$tot.withinss
kmeans(seed, 2)$tot.withinss
kmeans.si <- silhouette(seed.kmeans$cluster, seed.dist)
plot(kmeans.si)
dim(seed)
seed.kmeans4 <- kmeans(seed, 4)
kmeans.si <- silhouette(seed.kmeans4$cluster, seed.dist)
plot(kmeans.si)
seed.kmeans5 <- kmeans(seed, 5)
kmeans.si <- silhouette(seed.kmeans5$cluster, seed.dist)
plot(kmeans.si)
seed.kmeans6 <- kmeans(seed, 6)
kmeans.si <- silhouette(seed.kmeans6$cluster, seed.dist)
plot(kmeans.si)
seed.kmeans4 <- kmeans(seed, 4)
kmeans.si <- silhouette(seed.kmeans4$cluster, seed.dist)
seed.kmeans4 <- kmeans(seed, 4)
kmeans.si <- silhouette(seed.kmeans4$cluster, seed.dist)
plot(kmeans.si)
seed.kmeans5 <- kmeans(seed, 5)
kmeans.si <- silhouette(seed.kmeans5$cluster, seed.dist)
plot(kmeans.si)
kmeans.si <- silhouette(seed.kmeans$cluster, seed.dist)
plot(kmeans.si)
plot(seed.pc, col = seed.kmeans$cluster, pch = 20, cex = 2, main = 
    "Clusters identified by k-means")
plot(seed, col = seed.kmeans$cluster, pch = 18)
plot(seed, col = seed.kmeans$cluster)
plot(seed, col = seed.pam$cluster)
plot(seed, col = seed.kmeans$cluster)
windows(0
windows()
plot(seed, col = seed.pam$cluster)
plot(seed, col = rev(seed.pam$cluster))
plot(seed, col = seed.pam$cluster)
q()
cars
head(cars)
ls()
head(carMarks)
dim(carMarks)
S <- cov(carMarks[, 3:10])
S
round(S, 2)
n <- dim(carMarks)[1]
round(S * n/(n-1), 2)
S <- cov(carMarks[, 3:10])*(n/(n-1))
round(S, 2)
S <- cov(carMarks[, 3:10])*((n-1)/n)
round(S, 2)
S <- cov(carMarks[, 3:10])*(n-1)/n
round(S, 2)
var(carMarks$Price)
sum(carMarks$Price - mean(carMarks$Price))
sum((carMarks$Price - mean(carMarks$Price))^2)
sum((carMarks$Price - mean(carMarks$Price))^2) / n
sum((carMarks$Value - mean(carMarks$Value))^2) / n
round(S, 2)
SXX <- S[1:2, 1:2]
SYY <- S[3:8, 3:8]
SXY <- S[1:2, 3:8]
SXX
SXY
SYY
search()
K <- (SXX %^% (-1/2)) %*% SXY %*% (SYY %^% (-1/2))
k
K
svd(K)
UDV <- svd(K)
sqrt(UDV)$d
sqrt(UDV$d)
1.602/(1.602+1.686)
1.602/sqrt((1.602+1.686)^2)
1.602/sqrt(1.602^2+1.686^2)
norm()
norm(1.602)
?norm
sqrt((1.602 - 1.686)^2)
sqrt(1.602^2 + 1.686^2)
1.602/sqrt(1.602^2 + 1.686^2)
1.686/sqrt(1.602^2 + 1.686^2)
sqrt((1.602/2.326)^2 + (1.686/2.326)^2)
a <- 1.602/sqrt(1.602^2 + 1.686^2)
b <- 1.686/sqrt(1.602^2 + 1.686^2)
sqrt(a^2 + b^2)
a
b
eigen(t(K) %*% K)
eigen(K %*% t(K))
svd(K)
zufb
UDV
UDV <- svd(K)
UDV
sqrt(eigen(K %*% t(K))$values)
coeff <- UDV$d
coeff
a <- UDV$u[, 1]
b <- UDV$v[, 1]
t(a) %*% carMarks
t(a) %*% as.matrix(carMarks[, 3:10])
a
t(a)
t(a) %*% as.matrix(carMarks[1:2, 3:10])
phi <- t(b) %*% as.matrix(carMarks[3:8, 3:10])
phi
a
b
coeff
plot(eta, phi)
length(eta)
length(phi)
phi
phi <- t(b) %*% as.matrix(carMarks[3:8, 3:10])
phi
eta
eta <- t(a) %*% as.matrix(carMarks[1:2, 3:10])
eta
plot(eta, phi)
text(eta, phi, labels = colnames(carMarks)[, 3:10])
text(eta, phi, labels = colnames(carMarks)[3:10])
as.matrix(carMarks[1:2, 3:10])
b
eta <- t(a) %*% as.matrix(carMarks[, 3:4])
eta <- a %*% as.matrix(carMarks[, 3:4])
eta <- t(a) %*% t(as.matrix(carMarks[, 3:4]))
phi <- t(b) %*% t(as.matrix(carMarks[, 5:10]))
plot(eta, phi)
text(eta, phi, labels = colnames(carMarks)[3:10])
names(carMarks)
plot(eta, phi)
text(eta, phi, labels = Type)
text(eta, phi, labels = carMarks$Type)
plot(eta, phi)
text(eta, phi, labels = carMarks$Model)
plot(eta, phi)
text(eta, phi, labels = carMarks$Type)
dim(carMarks)
head(cars)
head(carMarks)
B7 <- read.csv("./Data/CarMarks.csv")
head(B7)
n <- dim(B7)[1]
S <- cov(B7[, 3:10])*(n-1)/n# convert to MLE 
S
round(S, 2)
head(B7)
 B7[, c(1,2,6,5,3,4,7:10)]
B7 <- B7[, c(1,2,6,5,3,4,7:10)]
n <- dim(B7)[1]
S <- cov(B7[, 3:10])*(n-1)/n# convert to MLE 
round(S, 2)
S <- cov(B7[, 3:10])# convert to MLE 
round(S, 2)
*(n-1)/n
S <- cov(B7[, 3:10])*(n-1)/n# convert to MLE 
B7 <- read.csv("./Data/CarMarks.csv")
S <- cov(B7[, 3:10])*(n-1)/n# convert to MLE 
S
n <- dim(carMarks)[1]
S <- cov(carMarks[, 3:10])*(n-1)/n# convert to MLE 
eta <- t(-a) %*% t(as.matrix(carMarks[, 3:4]))
phi <- t(-b) %*% t(as.matrix(carMarks[, 5:10]))
plot(eta, phi)
text(eta, phi, labels = carMarks$Type)
cor(eta)
cor(phi)
cor(eta, phi)
cov(eta, phi)
eta
phi
var(eta)
cor(as.data.frame(eta), as.data.frame(phi))
as.data.frame(eta)
cor(t(eta), t(phi))
cov(t(eta), t(phi))
dim(carMarks)
dim(UVD$u)
dim(UDV$u)
-(n - (dim(UDV$u)[1] + dim(UDV$v)[1] + 3)/ 2) * log(sum(1 - UDV$d))
n
dim(UDV$u)[1]
im(UDV$v)[1]
dim(UDV$v)[1]
1 - UDV$d
-(n - (dim(UDV$u)[1] + dim(UDV$v)[1] + 3)/ 2) * log(sum(1 - UDV$d^2))
T <- -(n - (dim(UDV$u)[1] + dim(UDV$v)[1] + 3)/ 2) * log(sum(1 - UDV$d^2))
pchisq(T, p*q)
p*q
p
q
pchisq(T, dim(UDV$u)[1]*dim(UDV$v)[1])
pchisq(T, dim(UDV$u)[1]*dim(UDV$v)[1], lower.tail = FALSE)
solve(SYY) %*% SYX %*% solve(SXX) %*% SXY
solve(SYY) %*% t(SXY) %*% solve(SXX) %*% SXY
bartlett.test(list(carMarks[, 1:2]), carMarks[, 3:10])
bartlett.test(list(carMarks[, 1:2], carMarks[, 3:10]))
cortest.bartlett(cor(carMarks[, 1:2], carMarks[, 3:10]))
library(psych)
cortest.bartlett(cor(carMarks[, 1:2], carMarks[, 3:10]))
bartlett.test(list(carMarks[, 3:4], carMarks[, 5:10]))
cortest.bartlett(cor(carMarks[, 3:4], carMarks[, 3:10]))
cor(carMarks[, 3:4], carMarks[, 3:10])
cortest.bartlett(cor(carMarks))
cortest.bartlett(cor(carMarks[, -(1:2)]))
cor(carMarks[, -(1:2)])
T <- -(n - (dim(UDV$u)[1] + dim(UDV$v)[1] + 3)/ 2) * log(sum(1 - UDV$d[1]^2)) 
T
UDV$d[1]
T <- -(n - (dim(UDV$u)[1] + dim(UDV$v)[1] + 3)/ 2) * log(sum(1 - UDV$d[2]^2)) 
T
pchisq(T, (dim(UDV$u)[1] - 1)*(dim(UDV$v)[1] - 1), lower.tail = FALSE)
(dim(UDV$u)[1] - 1)*(dim(UDV$v)[1] - 1)
q()
